<script src="./node_modules/ikagaka.nar.js/node_modules/encoding-japanese/encoding.js"></script>
<script src="./node_modules/ikagaka.nar.js/vender/jszip.min.js"></script>
<script src="./node_modules/ikagaka.nar.js/vender/XHRProxy.min.js"></script>
<script src="./node_modules/ikagaka.nar.js/vender/WMDescript.js"></script>
<script src="./node_modules/ikagaka.nar.js/Nar.js"></script>
<script src="./node_modules/underscore/underscore-min.js"></script>
<script src="./Ghost.js"></script>
<script>
var nar = new Nar();
nar.loadFromURL("./vender/TempleteKarin.nar", function (err){
  if(!!err) return console.error(err.stack);

  if(nar.install.type === "ghost"){
    var ghostDir = Object
      .keys(nar.directory)
      .filter(function(path){ return /ghost\/master\//.test(path); })
      .reduce(function(dir, path, zip){ dir[path.replace(/ghost\/master\//, "")] = nar.directory[path]; return dir; }, {})
    var ghost = new Ghost(ghostDir)
  }else{
    throw new Error("wrong nar file")
  }

  ghost.load(function(err){
    if(!!err) return console.error(err.stack);

    console.log(ghost);

    ghost.request("GET SHIORI/3.0\r\nID: Boot\r\nSender: ikagaka\r\nCharset: UTF-8\r\nReference0: master\r\n\r\n", function(err, response){
      if(!!err) return console.error(err.stack);

      console.log(response);
    });

  });
});
</script>
